version: 2
jobs:
  build:
    docker:
      - image: circleci/buildpack-deps:curl-browsers-legacy
    steps:
      - checkout
      - run:
          name: Greeting
          command: |
            echo Hello, world.
            echo $CIRCLE_BRANCH
            echo $CIRCLE_COMPARE_URL
            echo $CIRCLE_PULL_REQUEST
            echo $CIRCLE_PR_NUMBE
            git diff --name-only HEAD^ > diffs
            mkdir -p tmp/force-app/main/default/
            mv force-app/main/default/staticresources tmp/force-app/main/default/
            mkdir -p force-app/main/default/staticresources
            cd tmp
            cat diffs | while read line
            do
              if [[ $line =~ staticresources ]];
              then
                echo $line
                mv $line ../force-app/main/default/staticresources/
              fi
            done
            cd ..
            ls -R force-app/
